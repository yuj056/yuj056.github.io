![alt text](https://github.com/yuj056/yuj056.github.io/blob/master/_posts/Screen%20Shot%202018-06-12%20at%2010.51.39%20AM.png)
# Final period of work
## 1. Disadvantages of nested CVODE + IDA solvers
In the previous period of work, the nested solvers (CVODE + IDA) are used to calculate the DAE system, where IDA solver is applied to calculate the site fractions of the surface species at the steady state and CVODE is used to simulate the variables (u, &rho;, p, Y<sub>k</sub>) varing with the flow direction. However, after testing the isothermal reaction of SiF<sub>4</sub> and NH<sub>3</sub>, several problems show up: 1. In order to use CVODE solver, the equation of state need to be differentiate, which caused some drift problems and increase the simulation error. 2. The nested solvers work bad when the outer CVODE solver is an implicit one.
## 2. Use a single IDA solver rather than the nested solvers
Instead, we use a single IDA sovler to deal with our DAE system. The initial values of differential and algebraic variables are given and calcualted using `advance_to_coverages` respectively. Both differential and algebraic variables varing with the flow direction are calcualted inside the residual function of IDA solver. Considering the problem from the large value that I am getting for dp/dz for the pressure at the time of failure and to avoid inconsistencies, the residual equation for the equation of state (EoS) just changes to be `result = gas.pressure - vec_pressure`, which offloads the EoS calcualtion to Cantera, and has the added benefit of not necessarily assuming an ideal gas. The following screenshot shows the residual function of the IDA solver, the details can be found [here](https://github.com/yuj056/yuj056.github.io/blob/master/model/1D_pfr_surf_IDA.ipynb). The results seem correct by compared with the results of [Sundial paper](https://github.com/yuj056/yuj056.github.io/blob/master/_posts/Sandia.pdf).
![alt text](https://github.com/yuj056/yuj056.github.io/blob/master/_posts/fig_resid.png)
## 3. Complex the model by introducing the energy balance equation for adiabatic reactor
The previous simulation is based on the isothermal reactor model where the temperature of the gas and tube keep constant. However, the application of isothermal reactor is not prevalent, to further complex the model for reality use the adiabatic reator is considered. 
The heat flow rate into the system has two expressions, one is due to the heat flux q<sub>e</sub> from surroundings to the outer tube wall (whose surface area per unit length is a<sub>e</sub>) and accumulation of enthalpy in the bulk solid. The other is due to the q<sub>i</sub> is the heat flux to the gas from the inner tube wall and accumulation fo enthalpy in the surface species. The expression of energy balance equation for this problem shows as follows:
![alt text](https://github.com/yuj056/yuj056.github.io/blob/master/_posts/energy_eq.png)
Since the adiabatic reactor is considered, q<sub>e</sub> = 0. Similar procedure as isothermal reactor model, adding the energy equation into the residual function and calculate the initial value of the prime of the temperature. The detailed code can be found [here](https://github.com/yuj056/yuj056.github.io/blob/master/model/temp_change.ipynb).
## 4. Presentation of GSoC lighning talks at Seattle
I attended the GSoC lighning talks at Seattle on July 16th, which is hosted by Google and aim to share the ideas with other GSoCer. The presentation slides shows [here](https://github.com/yuj056/yuj056.github.io/blob/master/_posts/GSoC_pfr_surf.pdf), the objectives, idea and the preliminary results are illustrated in the slides. The GSoC coding approaches to the end, I really appreciate all the help and support by my mentors and Google!
